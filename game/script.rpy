init:
    #################################################################################################
    # Characters ####################################################################################
    #################################################################################################
    
    $ player = DynamicCharacter("player_name", color="#7fffd4", image="player")
    $ narrator = Character(None, color="#ffffff")
    $ nvnr = Character(None, kind=nvl)
    $ crewman = DynamicCharacter("crewman_name", color="#5f9ea0", image="crewman")
    $ carr = DynamicCharacter("carr_name", color="#5f9ea0", image="carr")
    $ sep1 = Character("Man in Rough Armor and Goggles", image="sep1")
    $ sep2 = Character("Helmeted Man", image="sep2")
    $ sep3 = Character("Man in Weather-Beaten Armor", image="sep3")
    
    #################################################################################################
    # Shake Effect ##################################################################################
    #################################################################################################
    
    python:
    
        import math

        class Shaker(object):
        
            anchors = {
                'top' : 0.0,
                'center' : 0.5,
                'bottom' : 1.0,
                'left' : 0.0,
                'right' : 1.0,
                }
        
            def __init__(self, start, child, dist):
                if start is None:
                    start = child.get_placement()
                #
                self.start = [ self.anchors.get(i, i) for i in start ]  # central position
                self.dist = dist    # maximum distance, in pixels, from the starting point
                self.child = child
                
            def __call__(self, t, sizes):
                # Float to integer... turns floating point numbers to
                # integers.                
                def fti(x, r):
                    if x is None:
                        x = 0
                    if isinstance(x, float):
                        return int(x * r)
                    else:
                        return x

                xpos, ypos, xanchor, yanchor = [ fti(a, b) for a, b in zip(self.start, sizes) ]

                xpos = xpos - xanchor
                ypos = ypos - yanchor
                
                nx = xpos + (1.0-t) * self.dist * (renpy.random.random()*2-1)
                ny = ypos + (1.0-t) * self.dist * (renpy.random.random()*2-1)

                return (int(nx), int(ny), 0, 0)
        
        def _Shake(start, time, child=None, dist=100.0, **properties):

            move = Shaker(start, child, dist=dist)
        
            return renpy.display.layout.Motion(move,
                          time,
                          child,
                          add_sizes=True,
                          **properties)

        Shake = renpy.curry(_Shake)

# The game starts here.
label start:
    #################################################################################################
    # Variables #####################################################################################
    #################################################################################################
    ## Character Names ##############################################################################
    #################################################################################################
    
    $ player_name = "Me"
    $ crewman_name = "Man in Uniform"
    $ carr_name = "Man in Dirty Uniform"
    
    #################################################################################################
    ## Alignment Tracking ###########################################################################
    #################################################################################################
    
    $ good = 0
    $ gray = 0
    $ dark = 0
    
    #################################################################################################
    ## Affection Tracking ###########################################################################
    #################################################################################################
    
    $ carrAffection = 0
    $ briggsAffection = 0
    $ yvetteAffection = 0
    
    #################################################################################################
    ## Relationship Paths ###########################################################################
    #################################################################################################
    
    $ carrRomance = False
    $ briggsRomance = False
    $ yvetteRomance = False
    
    $ carrFriendship = False
    $ briggsFriendship = False
    $ yvetteFriendship = False
    
    #################################################################################################
    ## Decisions/Events #############################################################################
    #################################################################################################
    ## Chapter Three ################################################################################
    #################################################################################################
    
    $ ch3_stayed_behind = False
    $ ch3_followed_carr = False
    $ ch3_forced_carr   = False
    
    #################################################################################################
    ## Miscellaneous ################################################################################
    #################################################################################################
    
    $ sshake = Shake((0, 0, 0, 0), 1.0, dist=15)
    
    #################################################################################################
    
    #jump chapter_one
    
    
    
    #################################################################################################
    #################################################################################################
    #################################################################################################
    # DEBUG ONLY
    #################################################################################################
    #################################################################################################
    #################################################################################################
    
    #################################################################################################
    ## Chapter Stats ################################################################################
    #################################################################################################
    ### Chapter 1 ###################################################################################
    #### Alignment: 3/3/3 (1 choice) 
    #################################################################################################
    ### Chapter 2 ###################################################################################
    #### Alignment: 5/5/5 (5 choices)
    #### Affection: 0 Carr
    #################################################################################################
    ### Chapter 3 ###################################################################################
    #### Alignment: 7/7/7 (3 choices)
    #### Affection: -1 to +2 Carr
    #################################################################################################
    
    #################################################################################################
    ## Starting Vars ################################################################################
    #################################################################################################
    
    $ good = 0
    $ gray = 15
    $ dark = 0
    
    $ carrAffection = 2
    $ briggsAffection = 0
    $ yvetteAffection = 0
    
    $ carrRomance = False
    $ briggsRomance = False
    $ yvetteRomance = False
    
    $ carrFriendship = False
    $ briggsFriendship = False
    $ yvetteFriendship = False
    
    $ player_name = "Mira"
    $ carr_name = "Lt. Carr"
    
    $ ch3_stayed_behind = True
    $ ch3_followed_carr = False
    $ ch3_forced_carr   = False
    
    #################################################################################################
    ## Chapter Fast Forward #########################################################################
    #################################################################################################
    
    jump chapter_four